<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Benchmark Experiments • mlr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../jquery.sticky-kit.min.js"></script><script src="../../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../index.html">mlr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/mlr.html">Get Started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Basics</li>
    <li>
      <a href="../../articles/tutorial/task.html">Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learners.html">Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/predict.html">Predict</a>
    </li>
    <li>
      <a href="../../articles/tutorial/performance.html">Performance</a>
    </li>
    <li>
      <a href="../../articles/tutorial/resample.html">Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/tune.html">Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/benchmark_experiments.html">Benchmark Experiments</a>
    </li>
    <li>
      <a href="../../articles/tutorial/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/visualization.html">Visualization</a>
    </li>
    <li class="dropdown-header">Advanced</li>
    <li>
      <a href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    </li>
    <li class="dropdown-header">Extend</li>
    <li class="dropdown-header">Appendix</li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mlr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Benchmark Experiments</h1>
            
          </div>

    
    
<div class="contents">
<p>In a benchmark experiment different learning methods are applied to one or several data sets with the aim to compare and rank the algorithms with respect to one or more performance measures.</p>
<p>In [%mlr] a benchmark experiment can be conducted by calling function [&amp;benchmark] on a <a href="&amp;base::list">list</a> of <a href="&amp;makeLearner">Learner</a>s and a <a href="&amp;base::list">list</a> of [&amp;Task]s. [&amp;benchmark] basically executes [&amp;resample] for each combination of <a href="&amp;makeLearner">Learner</a> and [&amp;Task]. You can specify an individual resampling strategy for each [&amp;Task] and select one or multiple performance measures to be calculated.</p>
<section id="conducting-benchmark-experiments" class="level2"><h2>Conducting benchmark experiments</h2>
<p>We start with a small example. Two learners, <a href="&amp;MASS::lda">linear discriminant analysis (lda)</a> and a <a href="&amp;rpart::rpart">classification tree (rpart)</a>, are applied to one classification problem ([&amp;sonar.task]). As resampling strategy we choose <code>"Holdout"</code>. The performance is thus calculated on a single randomly sampled test data set.</p>
<p>In the example below we create a resample description (<a href="&amp;makeResampleDesc">ResampleDesc</a>), which is automatically instantiated by [&amp;benchmark]. The instantiation is done only once per [&amp;Task], i.e., the same training and test sets are used for all learners. It is also possible to directly pass a <a href="&amp;makeResampleInstance">ResampleInstance</a>.</p>
<p>If you would like to use a <em>fixed test data set</em> instead of a randomly selected one, you can create a suitable <a href="&amp;makeResampleInstance">ResampleInstance</a> through function [&amp;makeFixedHoldoutInstance].</p>
<pre class="sourceCode r" id="cb1"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">## Two learners to be compared</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">lrns =<span class="st"> </span><span class="kw">list</span>(<span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.lda"</span>), <span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.rpart"</span>))</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">## Choose the resampling strategy</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Holdout"</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">## Conduct the benchmark experiment</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">bmr =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(lrns, sonar.task, rdesc)</a></code></pre>
<pre><code>## Task: Sonar-example, Learner: classif.lda</code></pre>
<pre><code>## Resampling: holdout</code></pre>
<pre><code>## Measures:             mmce</code></pre>
<pre><code>## [Resample] iter 1:    0.2571429</code></pre>
<pre><code>## </code></pre>
<pre><code>## Aggregated Result: mmce.test.mean=0.2571429</code></pre>
<pre><code>## </code></pre>
<pre><code>## Task: Sonar-example, Learner: classif.rpart</code></pre>
<pre><code>## Resampling: holdout</code></pre>
<pre><code>## Measures:             mmce</code></pre>
<pre><code>## [Resample] iter 1:    0.2714286</code></pre>
<pre><code>## </code></pre>
<pre><code>## Aggregated Result: mmce.test.mean=0.2714286</code></pre>
<pre><code>## </code></pre>
<pre class="sourceCode r" id="cb16"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">bmr</a></code></pre>
<pre><code>##         task.id    learner.id mmce.test.mean
## 1 Sonar-example   classif.lda      0.2571429
## 2 Sonar-example classif.rpart      0.2714286</code></pre>
<p>For convenience, if you don’t want to pass any additional arguments to [&amp;makeLearner], you don’t need to generate the <a href="&amp;makeLearner">Learner</a>s explicitly, but it’s sufficient to provide the learner name. In the above example we could also have written:</p>
<pre class="sourceCode r" id="cb18"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">## Vector of strings</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">lrns =<span class="st"> </span><span class="kw">c</span>(<span class="st">"classif.lda"</span>, <span class="st">"classif.rpart"</span>)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">## A mixed list of Learner objects and strings works, too</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">lrns =<span class="st"> </span><span class="kw">list</span>(<span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.lda"</span>, <span class="dt">predict.type =</span> <span class="st">"prob"</span>), <span class="st">"classif.rpart"</span>)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"></a>
<a class="sourceLine" id="cb18-7" data-line-number="7">bmr =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(lrns, sonar.task, rdesc)</a></code></pre>
<pre><code>## Task: Sonar-example, Learner: classif.lda</code></pre>
<pre><code>## Resampling: holdout</code></pre>
<pre><code>## Measures:             mmce</code></pre>
<pre><code>## [Resample] iter 1:    0.3000000</code></pre>
<pre><code>## </code></pre>
<pre><code>## Aggregated Result: mmce.test.mean=0.3000000</code></pre>
<pre><code>## </code></pre>
<pre><code>## Task: Sonar-example, Learner: classif.rpart</code></pre>
<pre><code>## Resampling: holdout</code></pre>
<pre><code>## Measures:             mmce</code></pre>
<pre><code>## [Resample] iter 1:    0.3142857</code></pre>
<pre><code>## </code></pre>
<pre><code>## Aggregated Result: mmce.test.mean=0.3142857</code></pre>
<pre><code>## </code></pre>
<pre class="sourceCode r" id="cb33"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">bmr</a></code></pre>
<pre><code>##         task.id    learner.id mmce.test.mean
## 1 Sonar-example   classif.lda      0.3000000
## 2 Sonar-example classif.rpart      0.3142857</code></pre>
<p>In the printed summary table every row corresponds to one pair of [&amp;Task] and <a href="&amp;makeLearner">Learner</a>. The entries show the mean misclassification error (<a href="measures.md">mmce</a>), the default performance measure for classification, on the test data set.</p>
<p>The result <code>bmr</code> is an object of class [&amp;BenchmarkResult]. Basically, it contains a <a href="&amp;base::list">list</a> of lists of [&amp;ResampleResult] objects, first ordered by [&amp;Task] and then by <a href="&amp;makeLearner">Learner</a>.</p>
<section id="making-experiments-reproducible" class="level3"><h3>Making experiments reproducible</h3>
<p>Typically, we would want our experiment results to be reproducible. [%mlr] obeys the <code>set.seed</code> function, so make sure to use <code>set.seed</code> at the beginning of your script if you would like your results to be reproducible.</p>
<p>Note that if you are using parallel computing, you may need to adjust how you call <code>set.seed</code> depending on your usecase. One possibility is to use <code>set.seed(123, "L'Ecuyer")</code> in order to ensure the results are reproducible for each child process. See the examples in <a href="&amp;parallel::mclapply">mclapply</a> for more information on reproducibility and parallel computing.</p>
</section></section><section id="accessing-benchmark-results" class="level2"><h2>Accessing benchmark results</h2>
<p>[%mlr] provides several accessor functions, named <code>getBMR&lt;WhatToExtract&gt;</code>, that permit to retrieve information for further analyses. This includes for example the performances or predictions of the learning algorithms under consideration.</p>
<section id="learner-performances" class="level3"><h3>Learner performances</h3>
<p>Let’s have a look at the benchmark result above. [&amp;getBMRPerformances] returns individual performances in resampling runs, while [&amp;getBMRAggrPerformances] gives the aggregated values.</p>
<pre class="sourceCode r" id="cb35"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(bmr)</a></code></pre>
<pre><code>## $`Sonar-example`
## $`Sonar-example`$classif.lda
##   iter mmce
## 1    1  0.3
## 
## $`Sonar-example`$classif.rpart
##   iter      mmce
## 1    1 0.3142857</code></pre>
<pre class="sourceCode r" id="cb37"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRAggrPerformances.html">getBMRAggrPerformances</a></span>(bmr)</a></code></pre>
<pre><code>## $`Sonar-example`
## $`Sonar-example`$classif.lda
## mmce.test.mean 
##            0.3 
## 
## $`Sonar-example`$classif.rpart
## mmce.test.mean 
##      0.3142857</code></pre>
<p>Since we used holdout as resampling strategy, individual and aggregated performance values coincide.</p>
<p>By default, nearly all “getter” functions return a nested <a href="&amp;base::list">list</a>, with the first level indicating the task and the second level indicating the learner. If only a single learner or, as in our case a single task is considered, setting <code>drop = TRUE</code> simplifies the result to a flat <a href="&amp;base::list">list</a>.</p>
<pre class="sourceCode r" id="cb39"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(bmr, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</a></code></pre>
<pre><code>## $classif.lda
##   iter mmce
## 1    1  0.3
## 
## $classif.rpart
##   iter      mmce
## 1    1 0.3142857</code></pre>
<p>Often it is more convenient to work with <a href="&amp;base::data.frame">data.frame</a>s. You can easily convert the result structure by setting <code>as.df = TRUE</code>.</p>
<pre class="sourceCode r" id="cb41"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(bmr, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</a></code></pre>
<pre><code>##         task.id    learner.id iter      mmce
## 1 Sonar-example   classif.lda    1 0.3000000
## 2 Sonar-example classif.rpart    1 0.3142857</code></pre>
<pre class="sourceCode r" id="cb43"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRAggrPerformances.html">getBMRAggrPerformances</a></span>(bmr, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</a></code></pre>
<pre><code>##         task.id    learner.id mmce.test.mean
## 1 Sonar-example   classif.lda      0.3000000
## 2 Sonar-example classif.rpart      0.3142857</code></pre>
</section><section id="predictions" class="level3"><h3>Predictions</h3>
<p>Per default, the [&amp;BenchmarkResult] contains the learner predictions. If you do not want to keep them, e.g., to conserve memory, set <code>keep.pred = FALSE</code> when calling [&amp;benchmark].</p>
<p>You can access the predictions using function [&amp;getBMRPredictions]. Per default, you get a nested <a href="&amp;base::list">list</a> of [&amp;ResamplePrediction] objects. As above, you can use the <code>drop</code> or <code>as.df</code> options to simplify the result.</p>
<pre class="sourceCode r" id="cb45"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRPredictions.html">getBMRPredictions</a></span>(bmr)</a></code></pre>
<pre><code>## $`Sonar-example`
## $`Sonar-example`$classif.lda
## Resampled Prediction for:
## Resample description: holdout with 0.67 split rate.
## Predict: test
## Stratification: FALSE
## predict.type: prob
## threshold: M=0.50,R=0.50
## time (mean): 0.00
##    id truth       prob.M    prob.R response iter  set
## 1 110     M 1.030021e-02 0.9896998        R    1 test
## 2  87     R 7.021385e-01 0.2978615        M    1 test
## 3 128     M 1.830008e-03 0.9981700        R    1 test
## 4  38     R 1.741571e-04 0.9998258        R    1 test
## 5  65     R 8.870874e-06 0.9999911        R    1 test
## 6  12     R 2.029072e-01 0.7970928        R    1 test
## ... (#rows: 70, #cols: 7)
## 
## $`Sonar-example`$classif.rpart
## Resampled Prediction for:
## Resample description: holdout with 0.67 split rate.
## Predict: test
## Stratification: FALSE
## predict.type: response
## threshold: 
## time (mean): 0.00
##    id truth response iter  set
## 1 110     M        R    1 test
## 2  87     R        R    1 test
## 3 128     M        R    1 test
## 4  38     R        R    1 test
## 5  65     R        M    1 test
## 6  12     R        R    1 test
## ... (#rows: 70, #cols: 5)</code></pre>
<pre class="sourceCode r" id="cb47"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">head</span>(<span class="kw"><a href="../../reference/getBMRPredictions.html">getBMRPredictions</a></span>(bmr, <span class="dt">as.df =</span> <span class="ot">TRUE</span>))</a></code></pre>
<pre><code>##         task.id  learner.id  id truth       prob.M    prob.R response iter
## 1 Sonar-example classif.lda 110     M 1.030021e-02 0.9896998        R    1
## 2 Sonar-example classif.lda  87     R 7.021385e-01 0.2978615        M    1
## 3 Sonar-example classif.lda 128     M 1.830008e-03 0.9981700        R    1
## 4 Sonar-example classif.lda  38     R 1.741571e-04 0.9998258        R    1
## 5 Sonar-example classif.lda  65     R 8.870874e-06 0.9999911        R    1
## 6 Sonar-example classif.lda  12     R 2.029072e-01 0.7970928        R    1
##    set
## 1 test
## 2 test
## 3 test
## 4 test
## 5 test
## 6 test</code></pre>
<p>It is also easily possible to access results for certain learners or tasks via their IDs. For this purpose many “getter” functions have a <code>learner.ids</code> and a <code>task.ids</code> argument.</p>
<pre class="sourceCode r" id="cb49"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">head</span>(<span class="kw"><a href="../../reference/getBMRPredictions.html">getBMRPredictions</a></span>(bmr, <span class="dt">learner.ids =</span> <span class="st">"classif.rpart"</span>, <span class="dt">as.df =</span> <span class="ot">TRUE</span>))</a></code></pre>
<pre><code>##         task.id    learner.id  id truth response iter  set
## 1 Sonar-example classif.rpart 110     M        R    1 test
## 2 Sonar-example classif.rpart  87     R        R    1 test
## 3 Sonar-example classif.rpart 128     M        R    1 test
## 4 Sonar-example classif.rpart  38     R        R    1 test
## 5 Sonar-example classif.rpart  65     R        M    1 test
## 6 Sonar-example classif.rpart  12     R        R    1 test</code></pre>
<p>If you don’t like the default IDs, you can set the IDs of learners and tasks via the <code>id</code> option of [&amp;makeLearner] and <a href="&amp;Task">make*Task</a>. Moreover, you can conveniently change the ID of a <a href="&amp;makeLearner">Learner</a> via function [&amp;setLearnerId].</p>
</section><section id="ids" class="level3"><h3>IDs</h3>
<p>The IDs of all <a href="&amp;makeLearner">Learner</a>s, [&amp;Task]s and <a href="&amp;makeMeasure">Measure</a>s in a benchmark experiment can be retrieved as follows:</p>
<pre class="sourceCode r" id="cb51"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRTaskIds.html">getBMRTaskIds</a></span>(bmr)</a></code></pre>
<pre><code>## [1] "Sonar-example"</code></pre>
<pre class="sourceCode r" id="cb53"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRLearnerIds.html">getBMRLearnerIds</a></span>(bmr)</a></code></pre>
<pre><code>## [1] "classif.lda"   "classif.rpart"</code></pre>
<pre class="sourceCode r" id="cb55"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRMeasureIds.html">getBMRMeasureIds</a></span>(bmr)</a></code></pre>
<pre><code>## [1] "mmce"</code></pre>
</section><section id="fitted-models" class="level3"><h3>Fitted models</h3>
<p>Per default the [&amp;BenchmarkResult] also contains the fitted models for all learners on all tasks. If you do not want to keep them set <code>models = FALSE</code> when calling [&amp;benchmark]. The fitted models can be retrieved by function [&amp;getBMRModels]. It returns a (possibly nested) <a href="&amp;base::list">list</a> of <a href="&amp;makeWrappedModel">WrappedModel</a> objects.</p>
<pre class="sourceCode r" id="cb57"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRModels.html">getBMRModels</a></span>(bmr)</a></code></pre>
<pre><code>## $`Sonar-example`
## $`Sonar-example`$classif.lda
## $`Sonar-example`$classif.lda[[1]]
## Model for learner.id=classif.lda; learner.class=classif.lda
## Trained on: task.id = Sonar-example; obs = 138; features = 60
## Hyperparameters: 
## 
## 
## $`Sonar-example`$classif.rpart
## $`Sonar-example`$classif.rpart[[1]]
## Model for learner.id=classif.rpart; learner.class=classif.rpart
## Trained on: task.id = Sonar-example; obs = 138; features = 60
## Hyperparameters: xval=0</code></pre>
<pre class="sourceCode r" id="cb59"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRModels.html">getBMRModels</a></span>(bmr, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</a></code></pre>
<pre><code>## $classif.lda
## $classif.lda[[1]]
## Model for learner.id=classif.lda; learner.class=classif.lda
## Trained on: task.id = Sonar-example; obs = 138; features = 60
## Hyperparameters: 
## 
## 
## $classif.rpart
## $classif.rpart[[1]]
## Model for learner.id=classif.rpart; learner.class=classif.rpart
## Trained on: task.id = Sonar-example; obs = 138; features = 60
## Hyperparameters: xval=0</code></pre>
<pre class="sourceCode r" id="cb61"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRModels.html">getBMRModels</a></span>(bmr, <span class="dt">learner.ids =</span> <span class="st">"classif.lda"</span>)</a></code></pre>
<pre><code>## $`Sonar-example`
## $`Sonar-example`$classif.lda
## $`Sonar-example`$classif.lda[[1]]
## Model for learner.id=classif.lda; learner.class=classif.lda
## Trained on: task.id = Sonar-example; obs = 138; features = 60
## Hyperparameters:</code></pre>
</section><section id="learners-and-measures" class="level3"><h3>Learners and measures</h3>
<p>Moreover, you can extract the employed <a href="&amp;makeLearner">Learner</a>s and <a href="&amp;makeMeasure">Measure</a>s.</p>
<pre class="sourceCode r" id="cb63"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRLearners.html">getBMRLearners</a></span>(bmr)</a></code></pre>
<pre><code>## $classif.lda
## Learner classif.lda from package MASS
## Type: classif
## Name: Linear Discriminant Analysis; Short name: lda
## Class: classif.lda
## Properties: twoclass,multiclass,numerics,factors,prob
## Predict-Type: prob
## Hyperparameters: 
## 
## 
## $classif.rpart
## Learner classif.rpart from package rpart
## Type: classif
## Name: Decision Tree; Short name: rpart
## Class: classif.rpart
## Properties: twoclass,multiclass,missings,numerics,factors,ordered,prob,weights,featimp
## Predict-Type: response
## Hyperparameters: xval=0</code></pre>
<pre class="sourceCode r" id="cb65"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRMeasures.html">getBMRMeasures</a></span>(bmr)</a></code></pre>
<pre><code>## [[1]]
## Name: Mean misclassification error
## Performance measure: mmce
## Properties: classif,classif.multi,req.pred,req.truth
## Minimize: TRUE
## Best: 0; Worst: 1
## Aggregated by: test.mean
## Arguments: 
## Note: Defined as: mean(response != truth)</code></pre>
</section></section><section id="merging-benchmark-results" class="level2"><h2>Merging benchmark results</h2>
<p>Sometimes after completing a benchmark experiment it turns out that you want to extend it by another <a href="&amp;makeLearner">Learner</a> or another [&amp;Task]. In this case you can perform an additional benchmark experiment and then use function [&amp;mergeBenchmarkResults] to combine the results to a single [&amp;BenchmarkResult] object that can be accessed and analyzed as usual.</p>
<p>For example in the benchmark experiment above we applied <a href="&amp;MASS::lda">lda</a> and <a href="&amp;rpart::rpart">rpart</a> to the [&amp;sonar.task]. We now perform a second experiment using a <a href="&amp;randomForest::randomForest">random forest</a> and <a href="&amp;MASS::qda">quadratic discriminant analysis (qda)</a> and merge the results.</p>
<pre class="sourceCode r" id="cb67"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">## First benchmark result</a>
<a class="sourceLine" id="cb67-2" data-line-number="2">bmr</a></code></pre>
<pre><code>##         task.id    learner.id mmce.test.mean
## 1 Sonar-example   classif.lda      0.3000000
## 2 Sonar-example classif.rpart      0.3142857</code></pre>
<pre class="sourceCode r" id="cb69"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1">## Benchmark experiment for the additional learners</a>
<a class="sourceLine" id="cb69-2" data-line-number="2">lrns2 =<span class="st"> </span><span class="kw">list</span>(<span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.randomForest"</span>), <span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.qda"</span>))</a>
<a class="sourceLine" id="cb69-3" data-line-number="3">bmr2 =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(lrns2, sonar.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb69-4" data-line-number="4">bmr2</a></code></pre>
<pre><code>##         task.id           learner.id mmce.test.mean
## 1 Sonar-example classif.randomForest      0.1714286
## 2 Sonar-example          classif.qda      0.4000000</code></pre>
<pre class="sourceCode r" id="cb71"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1">## Merge the results</a>
<a class="sourceLine" id="cb71-2" data-line-number="2"><span class="kw"><a href="../../reference/mergeBenchmarkResults.html">mergeBenchmarkResults</a></span>(<span class="kw">list</span>(bmr, bmr2))</a></code></pre>
<pre><code>##         task.id           learner.id mmce.test.mean
## 1 Sonar-example          classif.lda      0.3000000
## 2 Sonar-example        classif.rpart      0.3142857
## 3 Sonar-example classif.randomForest      0.1714286
## 4 Sonar-example          classif.qda      0.4000000</code></pre>
<p>Note that in the above examples in each case a <a href="&amp;makeResampleDesc">resample description</a> was passed to the [&amp;benchmark] function. For this reason <a href="&amp;MASS::lda">lda</a> and <a href="&amp;rpart::rpart">rpart</a> were most likely evaluated on a different training/test set pair than <a href="&amp;randomForest::randomForest">random forest</a> and <a href="&amp;MASS::qda">qda</a>.</p>
<p>Differing training/test set pairs across learners pose an additional source of variation in the results, which can make it harder to detect actual performance differences between learners. Therefore, if you suspect that you will have to extend your benchmark experiment by another <a href="&amp;makeLearner">Learner</a> later on it’s probably easiest to work with <a href="&amp;makeResampleInstance">ResampleInstance</a>s from the start. These can be stored and used for any additional experiments.</p>
<p>Alternatively, if you used a resample description in the first benchmark experiment you could also extract the <a href="&amp;makeResampleInstance">ResampleInstance</a>s from the [&amp;BenchmarkResult] <code>bmr</code> and pass these to all further [&amp;benchmark] calls.</p>
<pre class="sourceCode r" id="cb73"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">rin =<span class="st"> </span><span class="kw"><a href="../../reference/getBMRPredictions.html">getBMRPredictions</a></span>(bmr)[[<span class="dv">1</span>]][[<span class="dv">1</span>]]<span class="op">$</span>instance</a>
<a class="sourceLine" id="cb73-2" data-line-number="2">rin</a></code></pre>
<pre><code>## Resample instance for 208 cases.
## Resample description: holdout with 0.67 split rate.
## Predict: test
## Stratification: FALSE</code></pre>
<pre class="sourceCode r" id="cb75"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">## Benchmark experiment for the additional random forest</a>
<a class="sourceLine" id="cb75-2" data-line-number="2">bmr3 =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(lrns2, sonar.task, rin, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb75-3" data-line-number="3">bmr3</a></code></pre>
<pre><code>##         task.id           learner.id mmce.test.mean
## 1 Sonar-example classif.randomForest      0.1571429
## 2 Sonar-example          classif.qda      0.4857143</code></pre>
<pre class="sourceCode r" id="cb77"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">## Merge the results</a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="kw"><a href="../../reference/mergeBenchmarkResults.html">mergeBenchmarkResults</a></span>(<span class="kw">list</span>(bmr, bmr3))</a></code></pre>
<pre><code>##         task.id           learner.id mmce.test.mean
## 1 Sonar-example          classif.lda      0.3000000
## 2 Sonar-example        classif.rpart      0.3142857
## 3 Sonar-example classif.randomForest      0.1571429
## 4 Sonar-example          classif.qda      0.4857143</code></pre>
</section><section id="benchmark-analysis-and-visualization" class="level2"><h2>Benchmark analysis and visualization</h2>
<p>[%mlr] offers several ways to analyze the results of a benchmark experiment. This includes visualization, ranking of learning algorithms and hypothesis tests to assess performance differences between learners.</p>
<p>In order to demonstrate the functionality we conduct a slightly larger benchmark experiment with three learning algorithms that are applied to five classification tasks.</p>
<section id="example-comparing-lda-rpart-and-random-forest" class="level3"><h3>Example: Comparing lda, rpart and random Forest</h3>
<p>We consider <a href="&amp;MASS::lda">linear discriminant analysis (lda)</a>, <a href="&amp;rpart::rpart">classification trees (rpart)</a>, and <a href="&amp;randomForest::randomForest">random forests (randomForest)</a>. Since the default learner IDs are a little long, we choose shorter names in the <strong>R</strong> code below.</p>
<p>We use five classification tasks. Three are already provided by [%mlr], two more data sets are taken from package [%mlbench] and converted to [&amp;Task]s by function [&amp;convertMLBenchObjToTask].</p>
<p>For all tasks 10-fold cross-validation is chosen as resampling strategy. This is achieved by passing a single <a href="&amp;makeResampleDesc">resample description</a> to [&amp;benchmark], which is then instantiated automatically once for each [&amp;Task]. This way, the same instance is used for all learners applied to a single task.</p>
<p>It is also possible to choose a different resampling strategy for each [&amp;Task] by passing a <a href="&amp;base::list">list</a> of the same length as the number of tasks that can contain both <a href="&amp;makeResampleDesc">resample descriptions</a> and <a href="&amp;makeResampleInstance">resample instances</a>.</p>
<p>We use the mean misclassification error <a href="measures.md">mmce</a> as primary performance measure, but also calculate the balanced error rate (<a href="measures.md">ber</a>) and the training time (<a href="measures.md">timetrain</a>).</p>
<pre class="sourceCode r" id="cb79"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">## Create a list of learners</a>
<a class="sourceLine" id="cb79-2" data-line-number="2">lrns =<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb79-3" data-line-number="3">  <span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.lda"</span>, <span class="dt">id =</span> <span class="st">"lda"</span>),</a>
<a class="sourceLine" id="cb79-4" data-line-number="4">  <span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.rpart"</span>, <span class="dt">id =</span> <span class="st">"rpart"</span>),</a>
<a class="sourceLine" id="cb79-5" data-line-number="5">  <span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.randomForest"</span>, <span class="dt">id =</span> <span class="st">"randomForest"</span>)</a>
<a class="sourceLine" id="cb79-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb79-7" data-line-number="7"></a>
<a class="sourceLine" id="cb79-8" data-line-number="8">## Get additional Tasks from package mlbench</a>
<a class="sourceLine" id="cb79-9" data-line-number="9">ring.task =<span class="st"> </span><span class="kw"><a href="../../reference/convertMLBenchObjToTask.html">convertMLBenchObjToTask</a></span>(<span class="st">"mlbench.ringnorm"</span>, <span class="dt">n =</span> <span class="dv">600</span>)</a>
<a class="sourceLine" id="cb79-10" data-line-number="10">wave.task =<span class="st"> </span><span class="kw"><a href="../../reference/convertMLBenchObjToTask.html">convertMLBenchObjToTask</a></span>(<span class="st">"mlbench.waveform"</span>, <span class="dt">n =</span> <span class="dv">600</span>)</a>
<a class="sourceLine" id="cb79-11" data-line-number="11"></a>
<a class="sourceLine" id="cb79-12" data-line-number="12">tasks =<span class="st"> </span><span class="kw">list</span>(iris.task, sonar.task, pid.task, ring.task, wave.task)</a>
<a class="sourceLine" id="cb79-13" data-line-number="13">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb79-14" data-line-number="14">meas =<span class="st"> </span><span class="kw">list</span>(mmce, ber, timetrain)</a>
<a class="sourceLine" id="cb79-15" data-line-number="15">bmr =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(lrns, tasks, rdesc, meas, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb79-16" data-line-number="16">bmr</a></code></pre>
<pre><code>##                        task.id   learner.id mmce.test.mean ber.test.mean
## 1                 iris-example          lda     0.02000000    0.02222222
## 2                 iris-example        rpart     0.08000000    0.07555556
## 3                 iris-example randomForest     0.05333333    0.05250000
## 4             mlbench.ringnorm          lda     0.35000000    0.34605671
## 5             mlbench.ringnorm        rpart     0.17333333    0.17313632
## 6             mlbench.ringnorm randomForest     0.05833333    0.05806121
## 7             mlbench.waveform          lda     0.19000000    0.18257244
## 8             mlbench.waveform        rpart     0.28833333    0.28765247
## 9             mlbench.waveform randomForest     0.16500000    0.16306057
## 10 PimaIndiansDiabetes-example          lda     0.22778537    0.27148893
## 11 PimaIndiansDiabetes-example        rpart     0.25133288    0.28967870
## 12 PimaIndiansDiabetes-example randomForest     0.23685919    0.27543146
## 13               Sonar-example          lda     0.24619048    0.23986694
## 14               Sonar-example        rpart     0.30785714    0.31153361
## 15               Sonar-example randomForest     0.17785714    0.17442696
##    timetrain.test.mean
## 1               0.0039
## 2               0.0188
## 3               0.0655
## 4               0.0063
## 5               0.0136
## 6               0.6070
## 7               0.0100
## 8               0.0126
## 9               0.5897
## 10              0.0034
## 11              0.0075
## 12              0.5807
## 13              0.0273
## 14              0.0121
## 15              0.3070</code></pre>
<p>From the aggregated performance values we can see that for the iris- and PimaIndiansDiabetes-example <a href="&amp;MASS::lda">linear discriminant analysis</a> performs well while for all other tasks the <a href="&amp;randomForest::randomForest">random forest</a> seems superior. Training takes longer for the <a href="&amp;randomForest::randomForest">random forest</a> than for the other learners.</p>
<p>In order to draw any conclusions from the average performances at least their variability has to be taken into account or, preferably, the distribution of performance values across resampling iterations.</p>
<p>The individual performances on the 10 folds for every task, learner, and measure are retrieved below.</p>
<pre class="sourceCode r" id="cb81"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1">perf =<span class="st"> </span><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(bmr, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="kw">head</span>(perf)</a></code></pre>
<pre><code>##        task.id learner.id iter      mmce       ber timetrain
## 1 iris-example        lda    1 0.0000000 0.0000000     0.003
## 2 iris-example        lda    2 0.1333333 0.1666667     0.002
## 3 iris-example        lda    3 0.0000000 0.0000000     0.002
## 4 iris-example        lda    4 0.0000000 0.0000000     0.003
## 5 iris-example        lda    5 0.0000000 0.0000000     0.007
## 6 iris-example        lda    6 0.0000000 0.0000000     0.010</code></pre>
<p>A closer look at the result reveals that the <a href="&amp;randomForest::randomForest">random forest</a> outperforms the <a href="&amp;rpart::rpart">classification tree</a> in every instance, while <a href="&amp;MASS::lda">linear discriminant analysis</a> performs better than <a href="&amp;rpart::rpart">rpart</a> most of the time. Additionally <a href="&amp;MASS::lda">lda</a> sometimes even beats the <a href="&amp;randomForest::randomForest">random forest</a>. With increasing size of such [&amp;benchmark] experiments, those tables become almost unreadable and hard to comprehend.</p>
<p>[%mlr] features some plotting functions to visualize results of benchmark experiments that you might find useful. Moreover, [%mlr] offers statistical hypothesis tests to assess performance differences between learners.</p>
</section><section id="integrated-plots" class="level3"><h3>Integrated plots</h3>
<p>Plots are generated using [%ggplot2]. Further customization, such as renaming plot elements or changing colors, is easily possible.</p>
<section id="visualizing-performances" class="level4"><h4>Visualizing performances</h4>
<p>[&amp;plotBMRBoxplots] creates box or violin plots which show the distribution of performance values across resampling iterations for one performance measure and for all learners and tasks (and thus visualize the output of [&amp;getBMRPerformances]).</p>
<p>Below are both variants, box and violin plots. The first plot shows the <a href="measures.md">mmce</a> and the second plot the balanced error rate (<a href="measures.md">ber</a>). Moreover, in the second plot we color the boxes according to the <code>learner.id</code>s.</p>
<pre class="sourceCode r" id="cb83"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw"><a href="../../reference/plotBMRBoxplots.html">plotBMRBoxplots</a></span>(bmr, <span class="dt">measure =</span> mmce)</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<pre class="sourceCode r" id="cb84"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw"><a href="../../reference/plotBMRBoxplots.html">plotBMRBoxplots</a></span>(bmr, <span class="dt">measure =</span> ber, <span class="dt">style =</span> <span class="st">"violin"</span>, <span class="dt">pretty.names =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">color =</span> learner.id) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>))</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-17-2.png" width="672"></p>
<p>Note that by default the measure <code>name</code>s and the learner <code>short.name</code>s are used as axis labels.</p>
<pre class="sourceCode r" id="cb85"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">mmce<span class="op">$</span>name</a></code></pre>
<pre><code>## [1] "Mean misclassification error"</code></pre>
<pre class="sourceCode r" id="cb87"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">mmce<span class="op">$</span>id</a></code></pre>
<pre><code>## [1] "mmce"</code></pre>
<pre class="sourceCode r" id="cb89"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRLearnerIds.html">getBMRLearnerIds</a></span>(bmr)</a></code></pre>
<pre><code>## [1] "lda"          "rpart"        "randomForest"</code></pre>
<pre class="sourceCode r" id="cb91"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="kw"><a href="../../reference/getBMRLearnerShortNames.html">getBMRLearnerShortNames</a></span>(bmr)</a></code></pre>
<pre><code>## [1] "lda"   "rpart" "rf"</code></pre>
<p>If you prefer the <code>id</code>s like, e.g., mmce and ber set <code>pretty.names = FALSE</code> (as done for the second plot). Of course you can also use the [%ggplot2] functionality like the <a href="&amp;ggplot2::labs">ylab</a> function to choose completely different labels.</p>
<p>One question which comes up quite often is how to change the panel headers (which default to the [&amp;Task] IDs) and the learner names on the x-axis. For example looking at the above plots we would like to remove the “example” suffixes and the “mlbench” prefixes from the panel headers. Moreover, we want uppercase learner labels. Currently, the probably simplest solution is to change the factor levels of the plotted data as shown below.</p>
<pre class="sourceCode r" id="cb93"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">plt =<span class="st"> </span><span class="kw"><a href="../../reference/plotBMRBoxplots.html">plotBMRBoxplots</a></span>(bmr, <span class="dt">measure =</span> mmce)</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="kw">head</span>(plt<span class="op">$</span>data)</a></code></pre>
<pre><code>##        task.id learner.id iter      mmce       ber timetrain
## 1 iris-example        lda    1 0.0000000 0.0000000     0.003
## 2 iris-example        lda    2 0.1333333 0.1666667     0.002
## 3 iris-example        lda    3 0.0000000 0.0000000     0.002
## 4 iris-example        lda    4 0.0000000 0.0000000     0.003
## 5 iris-example        lda    5 0.0000000 0.0000000     0.007
## 6 iris-example        lda    6 0.0000000 0.0000000     0.010</code></pre>
<pre class="sourceCode r" id="cb95"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="kw">levels</span>(plt<span class="op">$</span>data<span class="op">$</span>task.id) =<span class="st"> </span><span class="kw">c</span>(<span class="st">"Iris"</span>, <span class="st">"Ringnorm"</span>, <span class="st">"Waveform"</span>, <span class="st">"Diabetes"</span>, <span class="st">"Sonar"</span>)</a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="kw">levels</span>(plt<span class="op">$</span>data<span class="op">$</span>learner.id) =<span class="st"> </span><span class="kw">c</span>(<span class="st">"LDA"</span>, <span class="st">"CART"</span>, <span class="st">"RF"</span>)</a>
<a class="sourceLine" id="cb95-3" data-line-number="3"></a>
<a class="sourceLine" id="cb95-4" data-line-number="4">plt <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Error rate"</span>)</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</section><section id="visualizing-aggregated-performances" class="level4"><h4>Visualizing aggregated performances</h4>
<p>The aggregated performance values (resulting from [&amp;getBMRAggrPerformances]) can be visualized by function [&amp;plotBMRSummary]. This plot draws one line for each task on which the aggregated values of one performance measure for all learners are displayed. By default, the first measure in the <a href="&amp;base::list">list</a> of <a href="&amp;makeMeasure">Measure</a>s passed to [&amp;benchmark] is used, in our example <a href="measures.md">mmce</a>. Moreover, a small vertical jitter is added to prevent overplotting.</p>
<pre class="sourceCode r" id="cb96"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw"><a href="../../reference/plotBMRSummary.html">plotBMRSummary</a></span>(bmr)</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
</section><section id="calculating-and-visualizing-ranks" class="level4"><h4>Calculating and visualizing ranks</h4>
<p>Additional to the absolute performance, relative performance, i.e., ranking the learners is usually of interest and might provide valuable additional insight.</p>
<p>Function [&amp;convertBMRToRankMatrix] calculates ranks based on aggregated learner performances of one measure. We choose the mean misclassification error (<a href="measures.md">mmce</a>). The rank structure can be visualized by [&amp;plotBMRRanksAsBarChart].</p>
<pre class="sourceCode r" id="cb97"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">m =<span class="st"> </span><span class="kw"><a href="../../reference/convertBMRToRankMatrix.html">convertBMRToRankMatrix</a></span>(bmr, mmce)</a>
<a class="sourceLine" id="cb97-2" data-line-number="2">m</a></code></pre>
<pre><code>##              iris-example mlbench.ringnorm mlbench.waveform
## lda                     1                3                2
## rpart                   3                2                3
## randomForest            2                1                1
##              PimaIndiansDiabetes-example Sonar-example
## lda                                    1             2
## rpart                                  3             3
## randomForest                           2             1</code></pre>
<p>Methods with best performance, i.e., with lowest <a href="measures.md">mmce</a>, are assigned the lowest rank. <a href="&amp;MASS::lda">Linear discriminant analysis</a> is best for the iris and PimaIndiansDiabetes-examples while the <a href="&amp;randomForest::randomForest">random forest</a> shows best results on the remaining tasks.</p>
<p>[&amp;plotBMRRanksAsBarChart] with option <code>pos = "tile"</code> shows a corresponding heat map. The ranks are displayed on the x-axis and the learners are color-coded.</p>
<pre class="sourceCode r" id="cb99"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="kw"><a href="../../reference/plotBMRRanksAsBarChart.html">plotBMRRanksAsBarChart</a></span>(bmr, <span class="dt">pos =</span> <span class="st">"tile"</span>)</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>A similar plot can also be obtained via [&amp;plotBMRSummary]. With option <code>trafo = "rank"</code> the ranks are displayed instead of the aggregated performances.</p>
<pre class="sourceCode r" id="cb100"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="kw"><a href="../../reference/plotBMRSummary.html">plotBMRSummary</a></span>(bmr, <span class="dt">trafo =</span> <span class="st">"rank"</span>, <span class="dt">jitter =</span> <span class="dv">0</span>)</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<p>Alternatively, you can draw stacked bar charts (the default) or bar charts with juxtaposed bars (<code>pos = "dodge"</code>) that are better suited to compare the frequencies of learners within and across ranks.</p>
<pre class="sourceCode r" id="cb101"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="kw"><a href="../../reference/plotBMRRanksAsBarChart.html">plotBMRRanksAsBarChart</a></span>(bmr)</a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="kw"><a href="../../reference/plotBMRRanksAsBarChart.html">plotBMRRanksAsBarChart</a></span>(bmr, <span class="dt">pos =</span> <span class="st">"dodge"</span>)</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-24-1.png" width="50%"><img src="benchmark_experiments_files/figure-html/unnamed-chunk-24-2.png" width="50%"></p>
</section></section><section id="comparing-learners-using-hypothesis-tests" class="level3"><h3>Comparing learners using hypothesis tests</h3>
<p>Many researchers feel the need to display an algorithm’s superiority by employing some sort of hypothesis testing. As non-parametric tests seem better suited for such benchmark results the tests provided in [%mlr] are the <strong>Overall Friedman test</strong> and the <strong>Friedman-Nemenyi post hoc test</strong>.</p>
<p>While the ad hoc <a href="&amp;friedmanTestBMR">Friedman test</a> based on <a href="&amp;stats::friedman.test">friedman.test</a> from the [%stats] package is testing the hypothesis whether there is a significant difference between the employed learners, the post hoc <a href="&amp;friedmanPostHocTestBMR">Friedman-Nemenyi test</a> tests for significant differences between all pairs of learners. <em>Non parametric</em> tests often do have less power then their <em>parametric</em> counterparts but less assumptions about underlying distributions have to be made. This often means many <strong>data sets</strong> are needed in order to be able to show significant differences at reasonable significance levels.</p>
<p>In our example, we want to compare the three learners on the selected data sets. First we might we want to test the hypothesis whether there is a difference between the learners.</p>
<pre class="sourceCode r" id="cb102"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw"><a href="../../reference/friedmanTestBMR.html">friedmanTestBMR</a></span>(bmr)</a></code></pre>
<pre><code>## 
##  Friedman rank sum test
## 
## data:  mmce.test.mean and learner.id and task.id
## Friedman chi-squared = 5.2, df = 2, p-value = 0.07427</code></pre>
<p>In order to keep the computation time for this tutorial small, the <a href="&amp;makeLearner">Learner</a>s are only evaluated on five tasks. This also means that we operate on a relatively low significance level <span class="math inline">\(\alpha = 0.1\)</span>. As we can reject the null hypothesis of the Friedman test at a reasonable significance level we might now want to test where these differences lie exactly.</p>
<pre class="sourceCode r" id="cb104"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw"><a href="../../reference/friedmanPostHocTestBMR.html">friedmanPostHocTestBMR</a></span>(bmr, <span class="dt">p.value =</span> <span class="fl">0.1</span>)</a></code></pre>
<pre><code>## 
##  Pairwise comparisons using Nemenyi multiple comparison test 
##              with q approximation for unreplicated blocked data 
## 
## data:  mmce.test.mean and learner.id and task.id 
## 
##              lda   rpart
## rpart        0.254 -    
## randomForest 0.802 0.069
## 
## P value adjustment method: none</code></pre>
<p>At this level of significance, we can reject the null hypothesis that there exists no performance difference between the decision tree (<a href="&amp;rpart::rpart">rpart</a>) and the <a href="&amp;randomForest::randomForest">random Forest</a>.</p>
</section><section id="critical-differences-diagram" class="level3"><h3>Critical differences diagram</h3>
<p>In order to visualize differently performing learners, a <a href="&amp;plotCritDifferences">critical differences diagram</a> can be plotted, using either the Nemenyi test (<code>test = "nemenyi"</code>) or the Bonferroni-Dunn test (<code>test = "bd"</code>).</p>
<p>The mean rank of learners is displayed on the x-axis.</p>
<ul>
<li>Choosing <code>test = "nemenyi"</code> compares all pairs of <a href="&amp;makeLearner">Learner</a>s to each other, thus the output are groups of not significantly different learners. The diagram connects all groups of learners where the mean ranks do not differ by more than the critical differences. Learners that are not connected by a bar are significantly different, and the learner(s) with the lower mean rank can be considered “better” at the chosen significance level.</li>
<li>Choosing <code>test = "bd"</code> performs a <em>pairwise comparison with a baseline</em>. An interval which extends by the given <em>critical difference</em> in both directions is drawn around the <a href="&amp;makeLearner">Learner</a> chosen as baseline, though only comparisons with the baseline are possible. All learners within the interval are not significantly different, while the baseline can be considered better or worse than a given learner which is outside of the interval.</li>
</ul>
<p>The critical difference <span class="math inline">\(\mathit{CD}\)</span> is calculated by <span class="math display">\[\mathit{CD} = q_\alpha \cdot \sqrt{\frac{k(k+1)}{6N}},\]</span> where <span class="math inline">\(N\)</span> denotes the number of tasks, <span class="math inline">\(k\)</span> is the number of learners, and <span class="math inline">\(q_\alpha\)</span> comes from the studentized range statistic divided by <span class="math inline">\(\sqrt{2}\)</span>. For details see <a href="http://www.jmlr.org/papers/volume7/demsar06a/demsar06a.pdf">Demsar (2006)</a>.</p>
<p>Function [&amp;generateCritDifferencesData] does all necessary calculations while function [&amp;plotCritDifferences] draws the plot. See the tutorial page about <a href="visualization.md">visualization</a> for details on data generation and plotting functions.</p>
<pre class="sourceCode r" id="cb106"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">## Nemenyi test</a>
<a class="sourceLine" id="cb106-2" data-line-number="2">g =<span class="st"> </span><span class="kw"><a href="../../reference/generateCritDifferencesData.html">generateCritDifferencesData</a></span>(bmr, <span class="dt">p.value =</span> <span class="fl">0.1</span>, <span class="dt">test =</span> <span class="st">"nemenyi"</span>)</a>
<a class="sourceLine" id="cb106-3" data-line-number="3"><span class="kw"><a href="../../reference/plotCritDifferences.html">plotCritDifferences</a></span>(g) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-27-1.png" width="672"></p>
<pre class="sourceCode r" id="cb107"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1">## Bonferroni-Dunn test</a>
<a class="sourceLine" id="cb107-2" data-line-number="2">g =<span class="st"> </span><span class="kw"><a href="../../reference/generateCritDifferencesData.html">generateCritDifferencesData</a></span>(bmr, <span class="dt">p.value =</span> <span class="fl">0.1</span>, <span class="dt">test =</span> <span class="st">"bd"</span>, <span class="dt">baseline =</span> <span class="st">"randomForest"</span>)</a>
<a class="sourceLine" id="cb107-3" data-line-number="3"><span class="kw"><a href="../../reference/plotCritDifferences.html">plotCritDifferences</a></span>(g) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-27-2.png" width="672"></p>
</section><section id="custom-plots" class="level3"><h3>Custom plots</h3>
<p>You can easily generate your own visualizations by customizing the <a href="&amp;ggplot2::ggplot">ggplot</a> objects returned by the plots above, retrieve the data from the <a href="&amp;ggplot2::ggplot">ggplot</a> objects and use them as basis for your own plots, or rely on the <a href="&amp;base::data.frame">data.frame</a>s returned by [&amp;getBMRPerformances] or [&amp;getBMRAggrPerformances]. Here are some examples.</p>
<p>Instead of boxplots (as in [&amp;plotBMRBoxplots]) we could create density plots to show the performance values resulting from individual resampling iterations.</p>
<pre class="sourceCode r" id="cb108"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">perf =<span class="st"> </span><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(bmr, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb108-2" data-line-number="2"></a>
<a class="sourceLine" id="cb108-3" data-line-number="3">## Density plots for two tasks</a>
<a class="sourceLine" id="cb108-4" data-line-number="4"><span class="kw">qplot</span>(mmce, <span class="dt">colour =</span> learner.id, <span class="dt">facets =</span> . <span class="op">~</span><span class="st"> </span>task.id,</a>
<a class="sourceLine" id="cb108-5" data-line-number="5">  <span class="dt">data =</span> perf[perf<span class="op">$</span>task.id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"iris-example"</span>, <span class="st">"Sonar-example"</span>),], <span class="dt">geom =</span> <span class="st">"density"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-6" data-line-number="6"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>))</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
<p>In order to plot multiple performance measures in parallel, <code>perf</code> is reshaped to long format. Below we generate grouped boxplots showing the error rate (<a href="measures.md">mmce</a>) and the training time <a href="measures.md">timetrain</a>.</p>
<pre class="sourceCode r" id="cb109"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">## Compare mmce and timetrain</a>
<a class="sourceLine" id="cb109-2" data-line-number="2">df =<span class="st"> </span>reshape2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/reshape2/topics/melt">melt</a></span>(perf, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">"task.id"</span>, <span class="st">"learner.id"</span>, <span class="st">"iter"</span>))</a>
<a class="sourceLine" id="cb109-3" data-line-number="3">df =<span class="st"> </span>df[df<span class="op">$</span>variable <span class="op">!=</span><span class="st"> "ber"</span>,]</a>
<a class="sourceLine" id="cb109-4" data-line-number="4"><span class="kw">head</span>(df)</a></code></pre>
<pre><code>##        task.id learner.id iter variable     value
## 1 iris-example        lda    1     mmce 0.0000000
## 2 iris-example        lda    2     mmce 0.1333333
## 3 iris-example        lda    3     mmce 0.0000000
## 4 iris-example        lda    4     mmce 0.0000000
## 5 iris-example        lda    5     mmce 0.0000000
## 6 iris-example        lda    6     mmce 0.0000000</code></pre>
<pre class="sourceCode r" id="cb111"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1"><span class="kw">qplot</span>(variable, value, <span class="dt">data =</span> df, <span class="dt">colour =</span> learner.id, <span class="dt">geom =</span> <span class="st">"boxplot"</span>,</a>
<a class="sourceLine" id="cb111-2" data-line-number="2">  <span class="dt">xlab =</span> <span class="st">"measure"</span>, <span class="dt">ylab =</span> <span class="st">"performance"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>task.id, <span class="dt">nrow =</span> <span class="dv">2</span>)</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
<p>It might also be useful to assess if learner performances in single resampling iterations, i.e., in one fold, are related. This might help to gain further insight, for example by having a closer look at train and test sets from iterations where one learner performs exceptionally well while another one is fairly bad. Moreover, this might be useful for the construction of ensembles of learning algorithms. Below, function <a href="&amp;GGally::ggpairs">ggpairs</a> from package [%GGally] is used to generate a scatterplot matrix of mean misclassification errors (<a href="&amp;measures.md">mmce</a>) on the <a href="&amp;mlbench::Sonar">Sonar</a> data set.</p>
<pre class="sourceCode r" id="cb112"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">perf =<span class="st"> </span><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(bmr, <span class="dt">task.id =</span> <span class="st">"Sonar-example"</span>, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb112-2" data-line-number="2">df =<span class="st"> </span>reshape2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/reshape2/topics/melt">melt</a></span>(perf, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">"task.id"</span>, <span class="st">"learner.id"</span>, <span class="st">"iter"</span>))</a>
<a class="sourceLine" id="cb112-3" data-line-number="3">df =<span class="st"> </span>df[df<span class="op">$</span>variable <span class="op">==</span><span class="st"> "mmce"</span>,]</a>
<a class="sourceLine" id="cb112-4" data-line-number="4">df =<span class="st"> </span>reshape2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/reshape2/topics/cast">dcast</a></span>(df, task.id <span class="op">+</span><span class="st"> </span>iter <span class="op">~</span><span class="st"> </span>variable <span class="op">+</span><span class="st"> </span>learner.id)</a>
<a class="sourceLine" id="cb112-5" data-line-number="5"><span class="kw">head</span>(df)</a></code></pre>
<pre><code>##         task.id iter  mmce_lda mmce_rpart mmce_randomForest
## 1 Sonar-example    1 0.2857143  0.2857143        0.14285714
## 2 Sonar-example    2 0.2380952  0.2380952        0.23809524
## 3 Sonar-example    3 0.3333333  0.2857143        0.28571429
## 4 Sonar-example    4 0.2380952  0.3333333        0.04761905
## 5 Sonar-example    5 0.1428571  0.2857143        0.19047619
## 6 Sonar-example    6 0.4000000  0.4500000        0.25000000</code></pre>
<pre class="sourceCode r" id="cb114"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1">GGally<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/GGally/topics/ggpairs">ggpairs</a></span>(df, <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre>
<p><img src="benchmark_experiments_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
</section></section><section id="further-comments" class="level2"><h2>Further comments</h2>
<ul>
<li>Note that for supervised classification [%mlr] offers some more plots that operate on [&amp;BenchmarkResult] objects and allow you to compare the performance of learning algorithms. See for example the tutorial page on <a href="roc_analysis.md">ROC curves</a> and functions [&amp;generateThreshVsPerfData], [&amp;plotROCCurves], and [&amp;plotViperCharts] as well as the page about <a href="classifier_calibration.md">classifier calibration</a> and function [&amp;generateCalibrationData].</li>
<li>In the examples shown in this section we applied “raw” learning algorithms, but often things are more complicated. At the very least, many learners have hyperparameters that need to be tuned to get sensible results. Reliable performance estimates can be obtained by <a href="nested_resampling.md">nested resampling</a>, i.e., by doing the tuning in an inner resampling loop while estimating the performance in an outer loop. Moreover, you might want to combine learners with pre-processing steps like imputation, scaling, outlier removal, dimensionality reduction or feature selection and so on. All this can be easily done using [%mlr]’s wrapper functionality. The general principle is explained in the section about <a href="&amp;wrapper.md">wrapped learners</a> in the Advanced part of this tutorial. There are also several sections devoted to common pre-processing steps.</li>
<li>Benchmark experiments can very quickly become computationally demanding. [%mlr] offers some possibilities for <a href="parallelization.md">parallelization</a>.</li>
</ul></section>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#conducting-benchmark-experiments">Conducting benchmark experiments</a></li>
      <li><a href="#accessing-benchmark-results">Accessing benchmark results</a></li>
      <li><a href="#merging-benchmark-results">Merging benchmark results</a></li>
      <li><a href="#benchmark-analysis-and-visualization">Benchmark analysis and visualization</a></li>
      <li><a href="#further-comments">Further comments</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
